\chapter{\textit{Data Warehousing} (DWing)} 

Os principais fatores para a adoção de um programa de métricas em 
organizações de desenvolvimento de software são\begin{inparaenum}[i)]
\item a regularidade da coleta de dados;
\item a utilização de uma metodologia eficiente e transparente nessa coleta; 
\item o uso de ferramentas (não-intrusivas) para automatizar a coleta; 
\item o uso de mecanismos de comunicação de resultados adequados para todos os envolvidos; 
\item o uso de sofisticadas técnicas de análise de dados;
\apud{Gopal2005}{Silveira2010}.
\end{inparaenum} 


\textit{Data Warehousing} (DWing) é uma coleção de tecnologias de suporte à decisão disposta a capacitar os reponsáveis por tomar decisões a fazê-las de forma mais rápida \apud{chaudhuri1997}{andre2000}. Em outras palavras, trata-se de um processo para montar e gerenciar dados vindos de várias fontes, com o objetivo de prover uma visão analítica de parte ou do todo do negócio \cite{gardner1998}. Desta forma, é possível em um ambiente de \textit{data warehousing} que as métricas de código-fonte sejam coletadas de fontes diversas em uma periodicidade definida, de forma automatizada, não intrusiva ao trabalho da equipe de desenvolvimento e que estas possam mostrar a qualidade total do código-fonte produzido pela equipe durante um determinado período de tempo (dias, meses, anos). 


\begin{figure}[h!]
\centering
	\includegraphics[keepaspectratio=true,scale=0.20]{figuras/Dwing.eps}
	\caption{Arquitetura de um ambiente de \textit{Data Warehousing}}
	\label{dwing}
\end{figure}
\FloatBarrier



A Figura \ref{dwing} descreve uma arquitetura geral de um ambiente de DWing, de tal forma que,

\begin{inparaenum}[i)]
	\item As setas 1 e 2 representam o processo de \textit{Extraction-Transformation-Load};
	
	\item A seta 3 representa as consultas \textit{On-Line Analytical Processing (OLAP)};
	
	\item por fim a seta 4 representa a visualização dos dados;

\end{inparaenum}
 
 	Cada um dos componentes da Figura \ref{dwing} é descrito nas seções subsequentes.



\section{\textit{Extraction-Transformation-Load} (ETL)}

As etapas de extração, transformação, carga e atualização do \textit{data
warehouse} formam o back-end e caracterizam o processo chamado Extraction-
Transform-Load (ETL). Esse processo pode ser dividido em três etapas distintas
que somadas podem consumir até 85\% de todo o esforço em um DWing
\cite{Kimball2002}.




\begin{easylist}[itemize]

& Extração: No ambiente de \textit{data warehousing}, os dados, que provêm de fontes distintas, tais como planilhas, bases relacionais em diferentes tipos de
banco de dados (MySQL, Oracle, PostgreSQL e etc) ou mesmo de web services, são inicialmente extraídos de fontes externas de dados para um ambiente de 
\textit{staging} que \citeonline{Kimball2002} considera com uma área de armazenamento intermediária entre fontes e o \textit{data warehouse}. Normalmente, é de natureza temporária e o seu conteúdo é apagado após a carga dos dados no \textit{data Warehouse}. 

& Transformação: Após os dados serem carregados na área de \textit{staging}, 
os dados passam por processos de transformações diversas. Estas podem envolver
desde uma simples transformação de ponto para vírgula até a realização de cálculos, como por exemplo, cálculos estatísticos. 


& Carga: Após as devidas transformações dos dados, os dados são carregados, em formato pré-definido pelo projeto do \textit{data warehouse},  em definitivo no afim de serem utilizados pelas consultas OLAP. 

\end{easylist}
 
\section{\textit{Data Warehouse}} 

\textit{Data Warehouse} (DW) é um conjunto de dados integrados, consolidados,históricos, segmentados por assunto, não-voláteis, variáveis em relação ao tempo, e de apoio às decisões gerenciais \cite{Inmon1992}, ou seja, trata-se de um repositório central e consolidado que se soma ao conjunto de tecnologias que compõem um ambiente maior, que é o DWing \cite{Kimball2002}. 


A necessidade de centralização e agregação dos dados em um \textit{data warehouse} mostrou que a modelagem relacional com a utilização das técnicas de normalização, que visam a eliminação da redundância de dados, não é eficiente quando se realiza consultas mais complexas que fazem uso frequente da operação JOIN entre várias tabelas, pois oneram recursos hardware com grandes quantidades de acesso físico a dados. \cite{Kimball2002}

Dado esse cenário, \citeonline{Kimball2002} propôs que o \textit{data warehouse} deve ser projetado de acordo com as técnicas de modelagem dimensional, que visam exibir os dados em níveis adequados de detalhes e otimizar consultas complexas \cite{valeria2012}. No modelo dimensional, são aceitos que as tabelas possuam redundância e esparcidade de dados e estas podem ser classificadas em tabelas fatos e tabelas dimensões. Estas contém dados textuais, que pode conter vários atributos descritivos que expressam relações hierarquizáveis do negócio. Já uma tabela fato é uma tabela primária no modelo dimensional onde os valores numéricos ou medidas do negócio são armazenados \cite{Kimball2002}. 


Quando se juntam fatos e dimensões, obtém-se o chamado esquema estrela, tal como se mostra na Figura \ref{estrela}. Quando em um modelo dimensional, se faz necessário uso da normalização, o modelo passa então a ser chamado por \textit{modelo snowflake}, cujo ganho de espaço é menor que 1\% do total necessário para armazenar o esquema do \textit{data warehouse} \apud{valeria2012}{Kimball2002}. Em ambos os casos, quando se relaciona três dimensões, obtém-se os cubos de dados \cite{Kimball2002}, tal como se mostra na Figura \ref{cube}.


\begin{figure}[ht!]
\centering
\includegraphics[keepaspectratio=true,scale=0.2]{figuras/star_schema.eps}
\caption{Exemplo de Esquema Estrela adaptado de \citeonline{valeria2012}}
\label{estrela}
\end{figure}
\FloatBarrier


\begin{figure}[h!]
\centering
\includegraphics[keepaspectratio=false,scale=0.85]{figuras/cube.eps}
\caption{Exemplo de Cubo de Dados}
\label{cube}
\end{figure}
\FloatBarrier


No esquema da Figura \ref{estrela}, percebe-se que uma tabela fato expressa um relacionamento muitos para muitos com as tabelas dimensões, mostrando assim que a navegabilidade dos dados quantitativos e qualitativos é mais intuitiva quando comparada com o modelo relacional normalizado \cite{Kimball2002}. Além disso, verifica-se que a tabela fato possui uma dimensão temporal associada, isto é, há fatos que ocorrem diariamente, como por exemplo, a venda de produtos em um supermercado. Contudo, é possível que as vendas sejam vistas por visões mensais, trimestrais, semestrais ou anuais. Logo, a granularidade dos fatos deve ser considerada na hora de projetar um \textit{data warehouse}. Além disto, deve-se ainda considerar as características do fato, pois quando os registros de uma tabela fato podem ser somados a qualquer dimensão, é dito que o fato é aditivo. Quando é possível apenas somar em relação a algumas dimensões, é dito que o fato é semiaditivo. Já quando o fato é usado apenas para registro e não pode ser somado em relação a nenhuma dimensão, é dito que o fato é não aditivo \cite{Inmon1992}.

\subsection{Metodologia do Projeto do \textit{Data Warehouse}}
\label{metodologia-dw}
\citeonline{Kimball2002} enuncia que o ambiente de DWing nasce na necessidade do negócio e logo o projeto de um \textit{data warehouse} deve seguir os seguintes passos: 

\begin{inparaenum}[1)]
	\item Selecionar o Processo de Negócio com requisito fundamental do 
	projeto DW;
	
	\item Verificar a periodicidade de coleta dos dados do processo de negócio (diários, semanais, mensais, trimestrais, semestrais ou anuais);
	
	\item Identificar as dimensões;
	
	\item Identificar os fatos;

\end{inparaenum} 


\section{\textit{On-Line Analytical Processing} (OLAP)}

O termo OLAP, inicialmente proposto por \citeonline{Codd1993}, é utilizado para caracterizar as operações de consulta e análise em um \textit{data warehouse} projetado sobre um modelo dimensional \cite{Kimball2002}. Isto permite consultas mais flexíveis quando comparadas com as consultas \textit{Online Transaction Processing} (OTLP) que são executadas em bancos de dados relacionais normalizados, visando a eliminação da redundância de dados.

As principais diferenças das operações \textit{On-Line Analytical Processing} (OLAP) para as operações 
\textit{Online Transaction Processing} (OTLP) são apresentados na Tabela 
\ref{olapxoltp}.

	\begin{table}[!ht]
	\begin{center}
	 \begin{tabular}{|p{5cm}|p{5cm}|}
		\hline
		OLAP & OLTP \\ \hline
		Modelagem Dimensional (Tabelas Fato e Dimensão) & Modelagem Relacional com a utilização das formas normais (3N, 4N, 5N) \\ \hline
		Dados armazenados em nível transacional e agregado    & Dados em nível em nível transacional        \\ \hline
		Visa o diminuir o uso do JOIN & Faz uso constante de Join   \\ \hline
		Análise de Dados & Atualização de dados
		\\ \hline
		Estrutura de tipicamente estática  & Estrutura tipicamente dinâmica      \\ \hline
		Proveem informações atuais e do passado & Geralmente sem suporte a estado temporal dos dados
		      \\ \hline

		\end{tabular}
		\caption{Diferenças entre OLAP e OLTP extraído de \citeonline{valeria2012}, \citeonline{andre2000} e \citeonline{hilmer2002}}
		\label{olapxoltp}
		\end{center}
		\end{table}
		\FloatBarrier

Segundo \citeonline{hilmer2002}, a consolidação é uma das mais importantes operações OLAP. Ela envolve a agregação de dados sobre uma ou mais hierarquias de dimensões. A generalização de uma consulta de consolidação pode ser representada formalmente através de: 

\textbf{Select} $\displaystyle P,F_{1}(m_1),..., F_p(m_p)$

\textbf{From} $\displaystyle C(D_1(A_{11}),...,D_n(A_{n+1})$

\textbf{Where} $\displaystyle \phi(D_1)$ \textbf{and} ... \textbf{and}  $\displaystyle\phi(D_n)$

\textbf{Group by} G

onde P representa os atributos a serem selecionados das dimensões. $\displaystyle F_{i}(m_1)$ para $\displaystyle (1 \leq i \leq p) $ representando uma função de agregação. A cláusula \textbf{From} $\displaystyle C(D_1(A_{11}),...,D_n(A_{n+1})$ indica que a fonte de dados está indexada por suas tabelas dimensões, sendo que cada uma destas é referenciada como $\displaystyle D_i ... D_n $ onde  $\displaystyle D_i $ contém  $\displaystyle K_i$ atributos de  $\displaystyle D_i(A_{i1})$, ... $ \displaystyle D_i(A_{ik_{i}}) $ que descrevem a dimensão.  A cláusula \textbf{Where} $\displaystyle \phi(D_i)$ é o predicado $\displaystyle (D_i(A_{ij}) = v_{ij}$, onde $\displaystyle v_{ij} \in dom(D_i(A_{ij}))$ onde $\displaystyle (1 \leq i \leq n) $ e $\displaystyle (1 \leq j \leq K_{i}) $. A cláusula \textbf{Group by} G $\displaystyle \subset {D_{i}(A_{ij})} $ tal que $\displaystyle (1 \leq i \leq n) $ e $\displaystyle (1 \leq j \leq K_{i})$.


As operações OLAP tem como objetivo prover visualização dos dados sob diferentes perspectivas gerenciais e comportar todas as atividades de análise. Estas podem ser feitas de maneira \textit{ad hoc}, por meio das ferramentas de suporte a operações OLAP. Contudo, há algumas que são documentadas pela literatura e são classificadas em dois grupos: Análise Prospectiva e Análise Seletiva \apud{chaudhuri1997}{andre2000}.

A análise prospectiva consiste em realizar a análise a partir de um conjunto inicial de dados para chegar a dados mais detalhados ou menos detalhados \cite{Inmon1992}. Já a análise seletiva tem como objetivo trazer à evidência para os dados \cite{andre2000}. Entre as operações de análise prospectiva estão:

\begin{easylist}[itemize]

& \textit{Drill-Down:} Descer no nível de detalhes dos dados de uma dimensão. isto é, adicionar cabeçalhos de linha de tabelas de dimensão \cite{Kimball2002}.

& \textit{Roll-Up:} contrário de Drill-Down, trata-se caminhar para a visão de dados mais agregados \apud{Kimball2002}{andre2000}. 


\end{easylist}

Considerando o exemplo do total de vendas no mês de novembro em uma rede de lojas, que agregam as Lojas Sul, Norte e Oeste, tal como se mostra a Tabela \ref{before}, a operação Drill-Down pode ser exemplificada, quando se adiciona a dimensão Produto na Tabela \ref{before}, isto é, aumentando o nível de detalhes, tendo então como resultado a Tabela \ref{after}. Já a operação de Roll-Up é o contrário, isto é, diminuir o nível de detalhe partindo da Tabela 
\ref{after} para Tabela \ref{before}.

\begin{table}[!ht]
\centering
\begin{tabular}{|l|l|l|}
\hline
Mês & Loja & Total de Unidades Vendidas \\ \hline
Novembro & Loja Sul & 200                        \\ \hline
Novembro & Loja Norte & 300                        \\ \hline
Novembro & Loja Oeste & 230                        \\ \hline
\end{tabular}
\caption{Exemplo do Total de Vendas de uma Rede de Lojas no mês de Novembro}
\label{before}
\end{table}
\FloatBarrier


\begin{table}[!ht]
\centering
\begin{tabular}{|l|l|l|l|l|l|}
\hline
\multirow{2}{*}{Mês} & \multirow{2}{*}{Loja} & \multicolumn{4}{c|}{Produto}                 \\ \cline{3-6} 
                     &                       & Produto A & Produto B & Produto C & Produto D \\ \hline
Novembro             & Loja Sul              & 10        & 70        & 50        & 70        \\ \hline
Novembro             & Loja Norte            & 100       & 60        & 50        & 90        \\ \hline
Novembro             & Loja Oeste            & 25        & 78        & 67        & 60        \\ \hline
\end{tabular}
\caption{Exemplo do Total de Vendas de uma rede de lojas no mês de novembro com a dimensão Produto}
\label{after}
\end{table}

\begin{easylist}[itemize]

& \textit{Drill-Across:} significa caminhar a partir de uma dimensão para
outra dimensão, combinando-as para mudar o enfoque da
análise \cite{andre2000}. O Drill Across pode ser aplicado à Tabela \ref{before}, obtendo assim a Tabela \ref{after-across}.
\end{easylist}

\begin{table}[!ht]
\centering
\begin{tabular}{|l|l|}
\hline
\multicolumn{2}{|c|}{Loja Norte} \\ \hline
\cline{1-2}
Produto         & Novembro       \\ \hline
Produto A & 100 \\ \hline
Produto B & 60  \\ \hline
Produto C & 50  \\ \hline
Produto D & 60  \\ \hline

\end{tabular}
\caption{Exemplo do Total de vendas da Loja Norte no mês de novembro}
\label{after-across}
\end{table}
\FloatBarrier

Entre as operações de análise seletiva estão:

\begin{easylist}[itemize]

& \textit{Slice and Dice:} Em português, significa cortar e fatiar. Esta operação seleciona pedaços transversais do modelo dimensional e em seguida aplica critérios de seleção sobre este pedaço. \cite{andre2000}. Ou seja, trata-se de uma operação semelhante a cláusula WHERE do SQL \cite{valeria2012}. A operação pode ser aplicada na Tabela \ref{before-slice}, obtendo assim a Tabela \ref{after-slice}.


\end{easylist}

\begin{table}[ht]
\centering
\begin{tabular}{|l|l|l|l|l|}
\hline
Produto                                          & \multicolumn{1}{|c|}{Loja} & Outubro & Novembro & Dezembro \\ \hline

%-------------------------------
\multicolumn{1}{|c|}{\multirow{3}{*}{Produto A}} & Loja Sul                   & 50      & 10       & 20       \\ \cline{2-5} 
& Loja Norte                 & 60      & 100      & 24       \\ \cline{2-5} 
& Loja Oeste                 & 70      & 25       & 53       \\ \hline

%-------------------------------------
\multirow{3}{*}{Produto B}                       & Loja Sul                   & 32      & 70       & 20       \\ \cline{2-5} 
& Loja Norte                 & 42      & 60       & 43       \\ \cline{2-5}

& Loja Oeste                 & 56      & 78       & 56       \\ \hline


%--------------------------
\multirow{3}{*}{Produto C}                       & Loja Sul                   & 34      & 50       & 23       \\ \cline{2-5} 
& Loja Norte                 & 45      & 50       & 74       \\ \cline{2-5} 
& Loja Oeste                 & 83      & 67       & 65       \\ \hline


%------------------------------------
\multirow{3}{*}{Produto D}                       & Loja Sul                   & 56      & 70       & 35       \\ \cline{2-5} 
& Loja Norte                 & 12      & 90       & 34       \\ \cline{2-5} 
& Loja Oeste                 & 64      & 60       & 23       \\ \hline

\end{tabular}
\caption{Exemplo de Vendas por produto de uma rede de lojas nos meses de novembro e dezembro}
\label{before-slice}
\end{table}


\begin{table}[ht]
\centering
\begin{tabular}{|c|l|l|l|}
\hline
\multicolumn{1}{|l|}{Produto} & \multicolumn{1}{|c|}{Loja} & Outubro & Novembro \\ \hline
\multirow{3}{*}{Produto A}    & Loja Sul                   & 50      & 10       \\ \cline{2-4} 
\multicolumn{1}{|l|}{}        & Loja Norte                 & 60      & 100      \\ \cline{2-4} 
\multicolumn{1}{|l|}{}        & Loja Oeste                 & 70      & 25       \\ \hline
\end{tabular}
\caption{Exemplo de Vendas do Produto A na rede de Lojas}
\label{after-slice}
\end{table}


\begin{easylist}[itemize]

& \textit{Pivoting:} Trata-se de uma operação de rotação de 90º em um cubo multidimensional, isto é, muda-se a orientação das tabelas dimensionais a fim de restringir a visualização das dimensões em uma tabela. \cite{andre2000}. A operação de Pivoting pode ser exemplificada ao partir da Tabela \ref{before-slice} para Tabela \ref{after-pivoting}.


\end{easylist}



\begin{table}[!ht]
\centering
\begin{tabular}{|c|l|l|l|l|}
\hline
\multicolumn{1}{|l|}{Loja}                        & Produto   & Outubro  & Novembro  & Dezembro \\ \hline
\multirow{4}{*}{Loja Sul}                         & Produto A & 50       & 10        & 20       \\ \cline{2-5} 
\multicolumn{1}{|l|}{}                            & Produto B & 32       & 70        & 20       \\ \cline{2-5} 
\multicolumn{1}{|l|}{}                            & Produto C & 34       & 50        & 23       \\ \cline{2-5} 
\multicolumn{1}{|l|}{}                            & Produto D & 56       & 70        & 35       \\ \hline
\multirow{4}{*}{Loja Norte}                       & Produto A & 60       & 100       & 24       \\ \cline{2-5} 
                                                  & Produto B & 42       & 60        & 43       \\ \cline{2-5} 
                                                  & Produto C & 45       & 50        & 74       \\ \cline{2-5} 
                                                  & Produto D & 12       & 90        & 34       \\ \hline
\multicolumn{1}{|l|}{\multirow{4}{*}{Loja Oeste}} & Produto A & 70       & 25        & 53       \\ \cline{2-5} 
\multicolumn{1}{|l|}{}                            & Produto B & 56       & 78        & 56       \\ \cline{2-5} 
\multicolumn{1}{|l|}{}                            & Produto C & 83       & 67        & 65       \\ \cline{2-5} 
\multicolumn{1}{|l|}{}                            & Produto D & 64       & 60        & 23       \\ \hline
\end{tabular}
\caption{Exemplo de Vendas por Loja para cada um dos Produtos nos meses de Novembro e Dezembro}
\label{after-pivoting}
\end{table}



\section {Visualização de Dados}

Dados transmitem importantes informações, logo cabe a quem deseja comunicá-los, escolher a forma mais efetiva de fazê-lo \cite{raquel2013}. Segundo \citeonline{raquel2013}, tabelas e gráficos são as formas mais comuns de transmitir as informações quantitativas, sendo que\begin{inparaenum}[i)]
\item tabelas são utilizadas para consulta de valores individuais que podem ser comparados envolvendo, em certos casos, mais de uma unidade de medida;
\item gráficos são indicados para exibição de informação quantitativa nos quais os valores indicam pontos de interesse e estes podem ser comparados por sua similaridades e dissimilaridades\end{inparaenum}. 


\citeonline{few2009now} destaca que ainda que técnicas tradicionais de visualização de dados, tais como tabelas, histogramas, gráficos de pizza, podem descrever quase todos os tipos da relação quantitativa tais como, séries temporais, desvio, parte-todo, distribuição, etc; as representações tradicionais não são suficientes para transmitir ao receptor efetivamente a mensagem que dados transmitem. Além disso, \citeonline{few2009now} enuncia que as formas tradicionais de visualização isoladamente não agregam nenhuma flexibilização à visualização de dados.


Uma das técnicas de visualização, que visam transmitir os dados efetivamente e que tem se destacado é o uso dos \textit{dashboards}, que são representações visuais das informações mais importantes e necessárias, que podem ser monitoradas simultaneamente, para atingir um ou mais objetivos de negócio \cite{raquel2013}. \citeonline{raquel2013} também enuncia que cada componente do \textit{dashboard} deve ser pequeno, conciso, claro e intuitivo de modo que o todo deve caber inteiramente em uma tela de computador, tal como se mostra na Figura \ref{dashboard}.



\begin{figure}[ht!]
\centering
	\includegraphics[keepaspectratio=true, scale=0.8]{figuras/dashboard1.eps}
	\caption{Exemplo de Dashboard extraído de 
	\citeonline{raquel2013}}
	\label{dashboard}
\end{figure}
\FloatBarrier






Em um próximo passo do trabalho, pretende-se implementar o \textit{Dashboard} para a visualização das métricas de código-fonte, dado que segundo \citeonline{raquel2013} um \textit{dashboard} tem como papel estratégico a apresentação dos principais indicadores para tomada de decisão, logo comunicando os dados de maneira mais eficiente quando comparado com a exibição de tabelas e gráficos isolados.


